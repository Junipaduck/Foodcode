<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.foodcode.mapper.StoreMapper">


	<!-- 새로운 가게 등록 작업을 위한 <insert>태그 -->
	 <insert id="insertStore">
	 
	 	<selectKey keyProperty="store_idx" resultType="int" order="BEFORE">
			SELECT IFNULL(MAX(store_idx), 0) FROM store 
 		</selectKey>

 		
	 	INSERT
	 		INTO store
	 		VALUES (
	 			#{store_idx} + 1
	 			,#{store_name} 
	 			,#{store_phone} 
	 			,#{store_address}  
	 			,#{store_type}
	 			,#{store_content}
	 			,#{store_time}  
	 			,#{store_license} 
	 			,now()
	 			,#{store_etc}
	 			,#{store_file}
	 			,#{store_file_path}
	 			,#{member_id} <!-- 로그인된 점주의 sId -->
	 			,'N'
	 		)
	 </insert>




	 <!-- 게시물 목록 조회 <select> 태그 -->
		 <select id="selectStoreList" resultType="com.itwillbs.foodcode.vo.StoreVO">
		 	SELECT *
		 		FROM store
		 		WHERE
		 			store_type = '한식'
		 		ORDER BY
		 			store_idx DESC
		 		LIMIT
					#{startRow}
					,#{listLimit}
			 		
		 		
<!-- 		 		<if test="!searchKeyword.equals('')"> -->
<!-- 				WHERE  -->
<!-- 				<choose> -->
<!-- 					<when test="searchType.equals('content')"> -->
<!-- 						store_name LIKE CONCAT('%', #{searchKeyword}, '%') -->
<!-- 					</when> -->
<!-- 				</choose> -->
<!-- 				</if> -->
		
	 	 </select>
	 	 
	 	 <select id="selectStoreList2" resultType="com.itwillbs.foodcode.vo.StoreVO">
		 	SELECT *
		 		FROM store
		 		WHERE store_type = '일식'
		 		ORDER BY store_idx DESC;
	 	 </select>
	 	 
	 	 <select id="selectStoreList3" resultType="com.itwillbs.foodcode.vo.StoreVO">
		 	SELECT *
		 		FROM store
		 		WHERE store_type = '중식'
		 		ORDER BY store_idx DESC;
	 	 </select>
	 	 
	 	 <select id="selectStoreList4" resultType="com.itwillbs.foodcode.vo.StoreVO">
		 	SELECT *
		 		FROM store
		 		WHERE store_type = '양식'
		 		ORDER BY store_idx DESC;
	 	 </select>
	 	 
	 	 <select id="selectStoreList5" resultType="com.itwillbs.foodcode.vo.StoreVO">
		 	SELECT *
		 		FROM store
		 		WHERE store_type = '요리주점'
		 		ORDER BY store_idx DESC;
	 	 </select>
	
		<select id="selectStoreList6" resultType="com.itwillbs.foodcode.vo.StoreVO">
		 	SELECT *
		 		FROM store
		 		WHERE store_type = '카페/디저트'
		 		ORDER BY store_idx DESC;
	 	 </select>

		<!-- 가게 상세페이지 1개 조회용 -->
		<select id="selectStoreInfo" resultType="com.itwillbs.foodcode.vo.StoreVO">
			SELECT *
				FROM store
				WHERE store_idx = ${store_idx}
		</select>


		<!-- 가게 전체 조회 -->
		<select id="selectStoreListAll" resultType="com.itwillbs.foodcode.vo.StoreVO">
			SELECT *
				FROM store
		</select>

		
		
		<!-- 글 목록 총 갯수 조회 (페이징 카운트)-->
		<select id="selectStoreListCount" resultType="int">
			SELECT COUNT(*)
				FROM store 
				<if test="!searchKeyword.equals('')">
					WHERE
					<choose>
						<when test="searchType.equals('content')">
							store_name LIKE CONCAT('%', #{searchKeyword}, '%')
						</when>
					</choose>
				</if>
		</select>
		
		
		

</mapper>



	 
	 
