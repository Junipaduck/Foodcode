<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.foodcode.mapper.CustomerMapper">
	<insert id="insertMember">
		<selectKey keyProperty="member_idx" resultType="int" order="BEFORE">
			SELECT IFNULL(MAX(member_idx), 0) FROM member
		</selectKey>
		INSERT 
		INTO member
		VALUES(
		#{member_idx}+1
		,'c'
		,#{member_name}
		,#{member_id}
		,#{member_passwd}
		,#{member_phone}
		,#{member_email}
		,#{member_birth}
		,#{member_gender}
		,now()
		)
	
	</insert>
	
	<select id="isSuccessMember" parameterType="String" resultType="boolean">
	SELECT IF(COUNT(*) = 1, 1, 0)
	FROM member
	WHERE member_id = #{member_id} AND member_passwd = #{member_passwd}
	</select>
	
	<select id="selectMember" resultType="com.itwillbs.foodcode.vo.MemberVO">
		SELECT 
		 member_idx
		,member_type
		,member_name
		,member_id
		,member_passwd
		,member_phone
		,member_email
		,member_birth
		,member_gender
		,now()
		FROM member
		WHERE member_id = #{sId}
	</select>
	
	<update id="modifyMember">
		UPDATE member
		SET 
		    member_email = #{member.member_email}
		  , member_phone = #{member.member_phone}
		  <if test="!modifyMember.equals('') and modifyMember != null">
		  , member_passwd = #{modifyMember}
		  </if>
		WHERE member_id = #{sId}
	
	</update>
	
	<delete id="deleteMember">
		DELETE 
		FROM member
		WHERE member_id = #{sId}
	</delete>
	
	<select id="getPasswd">
		SELECT member_passwd
			FROM member
				WHERE member_id = #{member_id}
	</select>
	<select id="getPassword">
	SELECT member_passwd
			FROM member
				WHERE member_id = #{sId}
	</select>
</mapper>
