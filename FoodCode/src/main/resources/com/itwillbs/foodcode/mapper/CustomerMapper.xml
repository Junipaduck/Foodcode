<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.itwillbs.foodcode.mapper.CustomerMapper">
	<insert id="insertCustomer">
		<selectKey keyProperty="c_idx" resultType="int" order="BEFORE">
			SELECT IFNULL(MAX(c_idx), 0) FROM customer
		</selectKey>
		INSERT 
		INTO customer
		VALUES(
		#{c_idx}+1
		,#{c_id}
		,#{c_passwd}
		,#{c_name}
		,#{c_email}
		,#{c_phone}
		,#{c_birth}
		,now()
		,#{c_gender}
		)
	
	</insert>
	
	<select id="isSuccessCustomer" parameterType="String" resultType="boolean">
	SELECT IF(COUNT(*) = 1, 1, 0)
	FROM customer
	WHERE c_id = #{c_id} AND c_passwd = #{c_passwd}
	</select>
	
	<select id="selectCustomer" resultType="com.itwillbs.foodcode.vo.CustomerVO">
		SELECT c_idx
			  ,c_id
			  ,c_passwd
			  ,c_name
			  ,c_email
			  ,c_phone
			  ,c_birth
			  ,c_join_date
			  ,c_gender
		FROM customer
		WHERE c_id = #{sId}
	</select>
	
	<update id="modifyCustomer">
		UPDATE customer
		SET 
		    c_email = #{c_email}
		  , c_phone = #{c_phone}
		  <if test="c_passwd2 neq ''">
		  , c_passwd = #{c_passwd2}
		  </if>
		WHERE c_id = #{sId}
	
	</update>
	
	<delete id="deleteCustomer">
		DELETE 
		FROM customer
		WHERE c_id = #{sId}
	</delete>
	
	<select id="getPasswd">
		SELECT c_passwd
			FROM customer
				WHERE c_id = #{c_id}
	</select>
	<select id="getPassword">
	SELECT c_passwd
			FROM customer
				WHERE c_id = #{sId}
	</select>
</mapper>
